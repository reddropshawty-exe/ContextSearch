# ContextSearch
Решение для удобного контекстного поиска документов на компьютере

## Инфраструктурные модели
В проекте доступно несколько вариантов экстракторов и эмбеддеров, которые можно
подобрать под разные источники данных:

- **Экстракторы:**
  - `PdfExtractor` — базовый вариант, интерпретирующий вход как текст.
  - `PlainTextExtractor` — для уже очищенных текстов/логов.
  - `HtmlExtractor` — удаляет HTML‑теги и нормализует пробелы.
- **Эмбеддеры:**
  - `MiniLMEmbedder` — хешевый аналог sentence-transformer’а.
  - `MeanWordHashEmbedder` — усреднение словарных векторов.
  - `CharacterNgramEmbedder` — нграммный вариант, устойчивый к опечаткам.

Нужные реализации выбираются через `ContainerConfig` в модуле
`infrastructure.config`, что позволяет быстро переключать пайплайн под текущий
датасет или эксперимент.

## Что уже готово
- **Домен и use cases.** В `domain.entities` лежат датаклассы `Document`,
  `Chunk`, `Query`, `RetrievalResult`, а в `domain.interfaces` — абстракции для
  экстракции, нарезки, эмбеддинга, хранилищ и переписывания/переранжирования.
  Оркестраторы `application/use_cases/ingest_documents.py`,
  `search.py` и `run_experiment.py` работают только с этими интерфейсами.
- **Инфраструктурные реализации.** Модули в `infrastructure/` покрывают весь
  жизненный цикл: текстовые экстракторы (`text_extraction/`), нарезчик
  `FixedWindowSplitter`, три эмбеддера (`embedding/`), in-memory хранилище,
  SQLite‑репозиторий документов и простые query‑модули. Параметры пайплайна
  задаются через `ContainerConfig`, поэтому можно комбинировать разные
  экстракторы и эмбеддеры под задачу.
- **UI‑слои.** В `ui/api/main.py` развёрнут FastAPI с эндпоинтами `/ingest`,
  `/documents`, `/search`, которые напрямую вызывают use cases. В
  `ui/web/app.py` есть Streamlit‑заглушка для ручной демонстрации ingest/search
  цепочек.

## Что можно улучшить дальше
- **Более глубокие экстракторы.** Расширить `PdfExtractor` поддержкой PyPDF2 или
  pdfminer, добавить обработку DOCX/HTML с извлечением метаданных и языков.
- **Настоящие эмбеддинги и storage.** Интегрировать sentence-transformers,
  fastText или open-source LLM, заменить in-memory store на FAISS/Qdrant и
  прописать конфигурацию подключения.
- **Сложные пайплайны запросов.** Добавить LLM‑переписывание, BM25‑retrieval и
  cross-encoder reranking, а также гибкие параметры top‑K и агрегации.
- **Наблюдаемость и тесты.** Ввести unit-тесты для use cases, structured logging
  в API, сбор метрик и сохранение результатов экспериментов.
